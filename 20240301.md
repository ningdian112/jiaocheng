# Autoware.universe in Ubuntu 22.04

## Autoware.universe in humble 

## install with official 
```bash 
sudo apt-get -y update
sudo apt-get -y install git

git clone https://github.com/autowarefoundation/autoware.git

cd autoware
./setup-dev-env.sh
```
Then the ROS2 shows install wrong, so we use the 
```bash
wget http://fishros.com/install -O fishros && . fishros
```
then change to the 
```bash 
./setup-dev-env.sh
```
Check the cuda has been installed 12.3 but there hasnt cudnn and tensorrt.
```bash
nvcc -V
cat /usr/local/cuda-12.3/include/cudnn_version.h | grep CUDNN_MAJOR -A 2
```

Download the cudnn-linux-x86_64-8.9.7.29_cuda12-archive.tar.xz and TensorRT-8.6.1.6.tar.xz

## Tips:
![tips](https://github.com/ningdian112/jiaocheng/blob/main/20240301/images/1709726617505.png)
plz note the red line normally hard to install by official method.

### ROS2 Humble
use the code to install 
```bash
wget http://fishros.com/install -O fishros && . fishros
```
 (option 1>>2>>1>>1) \
  [1]:一键安装(推荐):ROS(支持ROS/ROS2,树莓派Jetson)  \
  [2]:不更换继续安装 \
  [1]:Humble(ROS2) \
  [1]:Humble(ROS2)桌面版 

 ### other dependents
 


### cudnn
```bash
tar -xvf cudnn-linux-x86_64-8.9.7.29_cuda12-archive.tar.xz
```
copy the cudnn to cuda location
```bash
sudo cp cudnn-linux-x86_64-8.9.7.29_cuda12-archive/include/cudnn*.h /usr/local/cuda/include 
sudo cp -P cudnn-linux-x86_64-8.9.7.29_cuda12-archive/lib/libcudnn* /usr/local/cuda/lib64
sudo chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*
```
check the connect well with cudnn or not
```bash
cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2
```
### tensorrt
```bash
tar -xvf TensorRT-8.6.1.6.tar.xz
```
put the unzip file to /home and change the environment use sudo gedit ~/.bashrc 
```bash
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH：/home/8.6.1.6/lib
```
Test the example 
```bash
cd TensorRT-8.6.1.6/samples/sampleOnnxMNIST
make -j16
cd ../../bin/
./sample_onnx_mnist
```
test result shows:
[the picture of result](20240301/images/image_2024_03_06T11_43_07_444Z.png)

if wrong with: 
```bash
./sample_onnx_mnist: error while loading shared libraries: libnvinfer.so.8: cannot open shared object file: No such file or directory
```
so plus the environmen though $ sudo gedit /etc/ld.so.conf 
```bash
/home/TensorRT-8.6.1.6/lib
```
then $ sudo ldconfig
```bash
sudo cp -r TensorRT-8.6.1.6/lib/* /usr/lib
sudo cp -r TensorRT-8.6.1.6/include/* /usr/include
```
test again. 

install python package \
my python file is: /home/ning/TensorRT-8.6.1.6/python/tensorrt-8.6.1-cp310-none-linux_x86_64.whl \
then install 
```bash
pip install --force-reinstall tensorrt-8.6.1-cp310-none-linux_x86_64.whl
```
then open a new terminal 
```bash
python3
import tensorrt
tensorrt.__version__
```
get the version, install finished.

### autoware.universe source code install
Create the src directory and clone repositories into it. \
Autoware uses vcstool to construct workspaces. \
wating for download \
```bash
cd autoware
mkdir src
vcs import src < autoware.repos
```
![result](https://github.com/ningdian112/jiaocheng/blob/main/20240301/images/image_2024_03_06T11_43_07_444Z.png)

Install dependent ROS packages. 
Autoware requires some ROS 2 packages in addition to the core components. The tool rosdep allows an automatic search and installation of such dependencies. \
You might need to run rosdep update before rosdep install.```bash
source /opt/ros/humble/setup.bash
rosdep install -y --from-paths src --ignore-src --rosdistro $ROS_DISTRO
```
Finally \
Build the workspace 
```bash
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release
```
![result](https://github.com/ningdian112/jiaocheng/blob/main/20240301/images/image_2024_03_06T12_11_18_120Z.png)

and other selections about building
```bash
# only build select packages
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release --packages-select packagesname
# ignore select packages
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release --packages-ignore packagesname
# if has error, still build
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release --continue-on-error
```








